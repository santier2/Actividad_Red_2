===============================
 CONFIGURACIÃ“N MANUAL INICIAL
===============================

Objetivo: que la PC Sysadmin pueda hacer ping y entrar por SSH a:
- SW1 (Switch Principal)
- SW2 (Switch Remoto)
- R1 (MikroTik1)
- R2 (MikroTik2)

Bloque de gestiÃ³n: 10.10.12.0/29
- R1 (MikroTik1): 10.10.12.1
- SW1: 10.10.12.2
- SW2: 10.10.12.3
- R2 (MikroTik2): 10.10.12.4
- PC Sysadmin: 10.10.12.5

Usuario/clave comÃºn en todos: admin / 1234
-----------------------------------------------

ðŸ“Œ PC Sysadmin (Linux)
sudo ip addr flush dev ens3
sudo ip addr add 10.10.12.5/29 dev ens3
sudo ip link set ens3 up
sudo ip route add default via 10.10.12.1


ðŸ“Œ SW1 â€“ Switch Principal
conf t
 hostname SW1
 ip domain-name lab.local
 crypto key generate rsa modulus 1024
 username admin privilege 15 secret 1234

 line vty 0 4
  login local
  transport input ssh
 exit

# VLANs
vlan 239
 name NATIVA
vlan 1299
 name GESTION
exit

# Interfaz de gestiÃ³n
interface Vlan1299
 ip address 10.10.12.2 255.255.255.248
 no shutdown
exit

# Puerto hacia PC Sysadmin
interface Ethernet1/0
 switchport mode access
 switchport access vlan 1299
 no shutdown
exit

# Puerto hacia R1 â†’ ahora TRUNK
interface Ethernet0/0
 switchport trunk encapsulation dot1q
 switchport mode trunk
 switchport trunk native vlan 239
 switchport trunk allowed vlan 239,1299
 no shutdown
exit

ip default-gateway 10.10.12.1
end
write memory


ðŸ“Œ SW2 â€“ Switch Remoto
conf t
 hostname SW2
 ip domain-name lab.local
 crypto key generate rsa modulus 1024
 username admin privilege 15 secret 1234

 line vty 0 4
  login local
  transport input ssh
 exit

# VLANs
vlan 239
 name NATIVA
vlan 1299
 name GESTION
exit

# Interfaz de gestiÃ³n
interface Vlan1299
 ip address 10.10.12.3 255.255.255.248
 no shutdown
exit

# Puerto hacia R2 â†’ ahora TRUNK
interface Ethernet0/0
 switchport trunk encapsulation dot1q
 switchport mode trunk
 switchport trunk native vlan 239
 switchport trunk allowed vlan 239,1299
 no shutdown
exit

# Puerto hacia usuario remoto (solo gestiÃ³n)
interface Ethernet0/1
 switchport mode access
 switchport access vlan 1299
 no shutdown
exit

ip default-gateway 10.10.12.1
end
write memory


ðŸ“Œ R1 â€“ MikroTik1 (principal)
# Bridge con VLAN filtering
/interface bridge add name=br-core vlan-filtering=yes

# Puertos al bridge
/interface bridge port add bridge=br-core interface=ether2 comment="Hacia SW1"
/interface bridge port add bridge=br-core interface=ether3 comment="Hacia R2"

# VLANs en el bridge
/interface bridge vlan add bridge=br-core vlan-ids=239 untagged=ether2,ether3
/interface bridge vlan add bridge=br-core vlan-ids=1299 tagged=br-core,ether2,ether3

# Interfaz VLAN de gestiÃ³n
/interface vlan add name=gestion1299 vlan-id=1299 interface=br-core
/ip address add address=10.10.12.1/29 interface=gestion1299

# Usuario y SSH
/user add name=admin password=1234 group=full
/ip service set ssh disabled=no
/ip service set telnet disabled=yes
/ip service set ftp disabled=yes
/ip service set www disabled=yes

/system backup save name=trunk


ðŸ“Œ R2 â€“ MikroTik2 (remoto)
# Bridge con VLAN filtering
/interface bridge add name=br-remote vlan-filtering=yes

# Puertos al bridge
/interface bridge port add bridge=br-remote interface=ether2 comment="Hacia R1"
/interface bridge port add bridge=br-remote interface=ether1 comment="Hacia SW2"

# VLANs en el bridge
/interface bridge vlan add bridge=br-remote vlan-ids=239 untagged=ether1,ether2
/interface bridge vlan add bridge=br-remote vlan-ids=1299 tagged=br-remote,ether1,ether2

# Interfaz VLAN de gestiÃ³n
/interface vlan add name=gestion1299 vlan-id=1299 interface=br-remote
/ip address add address=10.10.12.4/29 interface=gestion1299

# Ruta hacia R1
/ip route add dst-address=0.0.0.0/0 gateway=10.10.12.1

# Usuario y SSH
/user add name=admin password=1234 group=full
/ip service set ssh disabled=no
/ip service set telnet disabled=yes
/ip service set ftp disabled=yes
/ip service set www disabled=yes

/system backup save name=trunk

-----------------------------------------------
### VerificaciÃ³n desde PC Sysadmin
ping -c 3 10.10.12.1
ping -c 3 10.10.12.2
ping -c 3 10.10.12.3
ping -c 3 10.10.12.4

ssh admin@10.10.12.2   # prueba acceso SSH a SW1
ssh admin@10.10.12.3   # prueba acceso SSH a SW2
ssh admin@10.10.12.1   # R1
ssh admin@10.10.12.4   # R2
